#!/bin/sh
# vim:set ft=sh:
# originates from https://github.com/uber/NullAway/blob/master/config/hooks/pre-commit

set -e

files=$( (git diff --cached --name-only --diff-filter=ACMR | grep -Ei "\.lua$") || true)
if [ -n "${files}" ]; then
    comma_files=$(echo "$files" | paste -s -d "," -) > /dev/null 2>&1
    stylua "$comma_files"
    git add "$(echo "$files" | paste -s -d " " -)"
fi
