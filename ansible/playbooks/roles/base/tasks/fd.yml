- name: Install fd-find package
  become: true
  apt:
    pkg:
      - fd-find
      - stow
    state: "{{ apt_package_state }}"

- name: Ensure user bin directory exists
  file:
    path: ~/.local/bin
    state: directory
    mode: '0755'

- name: Create fd symlink (fdfind -> fd)
  file:
    src: /usr/bin/fdfind
    dest: ~/.local/bin/fd
    state: link
    force: true

- name: Ensure config folder exists
  file:
    path: ~/.config/fd
    state: directory

- name: Create symlinks into dotfiles
  command: stow --target ~/ fd
  args:
    chdir: ~/code/dotfiles
  changed_when: false  # command module always shows changed; stow is idempotent, failures still detected via exit code
