# Automatic connection of Avantree raw microphone to WebRTC processing
# This ensures the raw microphone feeds into the echo cancellation processing

wireplumber.settings = {
  # Enable automatic linking
  linking.enabled = true
}

# Rule to automatically link raw Avantree mic to WebRTC processing input
session.default-routes = [
  {
    matches = [
      {
        # Match raw Avantree microphone
        node.name = "~alsa_input.usb-Avantree_Avantree_C81_PC.*mono-fallback"
      }
    ]
    actions = {
      create-stream = {
        direction = "output"
        target.object = "avantree_echo_cancel_capture"
        stream.dont-remix = true
      }
    }
  }
]